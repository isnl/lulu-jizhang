# PDF账单转Excel - 快速开始

## ✅ 工具已创建成功!

您的PDF账单已成功转换为Excel格式!

### 📁 生成的文件

- **Excel文件**: `2025年12月信用卡账单.xlsx`
- **位置**: `f:\AI记账软件\记账小程序\`
- **包含**: 38条交易记录

### 📊 Excel内容预览

| 序号 | 交易日期 | 交易说明 | 金额 | 类型 | 币种 |
|------|----------|----------|------|------|------|
| 1 | 2026-11-27 | 自动还款 | 11.00 | 收入 | CNY |
| 2 | 2026-11-11 | 财付通-素心微暖极简护肤 | 11.00 | 收入 | CNY |
| ... | ... | ... | ... | ... | ... |

---

## 🚀 三种使用方法

### 方法1: 拖放使用(最简单)

1. 将PDF文件拖放到 `convert-pdf.bat` 上
2. 自动生成同名Excel文件
3. 完成!

### 方法2: 命令行使用

```bash
# 进入tools目录
cd tools

# 转换PDF
python pdf-to-excel.py "账单.pdf"

# 或指定输出文件名
python pdf-to-excel.py "账单.pdf" -o "我的账单.xlsx"
```

### 方法3: 批量转换

创建批处理脚本 `batch-convert.bat`:

```batch
@echo off
cd tools
for %%f in (..\*.pdf) do (
    python pdf-to-excel.py "%%f"
)
pause
```

---

## 📦 已创建的文件

### 1. 核心工具
- `tools/pdf-to-excel.py` - Python转换脚本(主程序)
- `tools/requirements.txt` - Python依赖配置
- `tools/convert-pdf.bat` - Windows批处理脚本(拖放使用)

### 2. 文档
- `tools/PDF转Excel使用指南.md` - 详细使用说明
- `tools/快速开始.md` - 本文档

---

## 🔧 功能特点

✅ **自动识别表格** - 智能提取PDF中的交易明细表  
✅ **格式化输出** - 生成美观的Excel文件,带样式和颜色  
✅ **收支标记** - 支出显示红色,收入显示绿色  
✅ **自动汇总** - 计算总金额  
✅ **多格式支持** - 支持不同银行的PDF账单格式  

---

## 📝 转换结果

您的PDF账单转换结果:

```
============================================================
[工具] PDF账单转Excel工具
============================================================
[读取] 正在读取PDF: 2025年12月信用卡账单.pdf
   总页数: 2
[完成] PDF读取完成,共提取 2706 个字符
[表格] 正在提取表格数据...
   第1页找到 10 个表格
   第2页找到 16 个表格
[完成] 共提取 26 个表格
[解析] 正在解析信用卡账单...
[完成] 解析完成,共找到 38 条交易记录
[保存] 正在生成Excel文件: 2025年12月信用卡账单.xlsx
[完成] Excel文件已保存
   共 38 条交易记录
============================================================
[完成] 转换完成!
============================================================
```

---

## 💡 下一步

### 导入到记账系统

转换后的Excel文件可以:

1. **直接查看** - 用Excel/WPS打开查看交易明细
2. **导入系统** - 将数据导入到您的记账小程序
3. **数据分析** - 使用Excel进行进一步的数据分析

### 自定义解析规则

如果您的PDF格式特殊,可以修改 `pdf-to-excel.py` 中的解析规则:

- `_is_transaction_table()` - 识别交易表格
- `_map_columns()` - 映射列名
- `_parse_amount()` - 解析金额格式
- `_parse_date()` - 解析日期格式

---

## ❓ 常见问题

### Q: 转换后数据不准确?
A: 不同银行的PDF格式不同,可能需要调整解析规则。请查看生成的Excel,如有问题可以提供PDF样本优化脚本。

### Q: 提示缺少库?
A: 运行 `pip install pdfplumber openpyxl` 安装依赖

### Q: PDF是扫描件无法转换?
A: 扫描版PDF需要先进行OCR识别,转换为可选择文本的PDF

---

## 📞 需要帮助?

如果遇到问题或需要优化解析规则,请提供:
1. PDF账单样本(可脱敏)
2. 期望的输出格式
3. 遇到的具体错误信息

我会帮您优化转换脚本!
